#!/bin/bash -vx

install_dot () {
    readonly local user="$(who am i | awk '{print $1}')"
    
    case "$user" in
        root) prefix="";;
        *) prefix="/home";;
    esac
    
    local configs=(/etc/turbo_happiness/*)
    for config in "${configs[@]}"
    do
        # check && remove previous existing config.
        if [[ $config == *".dpkg-dist"* ]];
            then
                configs=(${configs[@]/$config})
                done;
        fi        
        
        # make backup of existing config
        if [[ -e $prefix/$user/.$config ]];
            then
                cp $prefix/$user/.$config $prefix/$user/$config.bk
                rm $prefix/$user/.$config;
        fi
        cp /etc/turbo_happiness/$config $prefix/$user/.$config;
    done
    exit 0
}

echo -n "Would you like to install dotfiles? [yn] "
read install_dot
case "$install_dot" in
    y*|Y*) install_dot;;
    n*|N*) echo "Goodbye...." && exit;;
esac
