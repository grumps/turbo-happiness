#!/bin/bash -e

install_dot () {
    echo -n "Who would you like to install dotfiles for?"
    read user
    
    getint passwd $user
    local status=$?

    if [[ $status -ne 0 ]]
        then
            echo "User not found..."
            exit;
        done
    fi

    echo "Only current package configs are used, so you must accept overiding current configs."
    
    configs=(/etc/turbo_happiness/*)
    for config in "${configs[@]}"
    do
        # check for previous configs.
        if [[ $config == *".dpkg-dist"* ]];
            then
                configs=(${configs[@]/$config})
            done
        fi        
        
        # make backup of existing config
        if [[ -e /home/$user/$config ]];
            then
                mv /home/$user/$config /home/$user/$config.bk
            done
        fi
        cp /etc/turbo_happiness/$config /home/$user/.$config
    done
}

echo -n "Would you like to install dotfiles? [yn] "
read install_dot
case "$install_dot" in
    y*|Y*) install_dot;;
    n*|N*) echo "Goodbye...." && exit;;
esac
